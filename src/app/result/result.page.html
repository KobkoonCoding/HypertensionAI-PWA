<ion-header class="ion-no-border">
  <ion-toolbar color="primary">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/input"></ion-back-button>
    </ion-buttons>
    <ion-title class="ion-text-center app-title">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="result-gradient-bg ion-padding">
  <div *ngIf="predictionResult" class="result-container animate__animated animate__fadeInUp">

    <!-- ‚ñà 1 ‚îÄ MAIN RESULT CARD -->
    <ion-card class="result-card">
      <ion-card-header>
        <ion-card-title class="ion-text-center">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</ion-card-title>
        <ion-card-subtitle class="ion-text-center">
          ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÄ‡∏°‡∏∑‡πà‡∏≠: {{ resultTimestamp | date:'medium' }}
        </ion-card-subtitle>
      </ion-card-header>

      <ion-card-content class="ion-text-center">
        <ion-icon name="analytics-outline" class="result-icon"></ion-icon>

        <h2 class="prediction-text"
            [ngClass]="{
              'low-risk-text'   : currentRiskLevel === 'low',
              'medium-risk-text': currentRiskLevel === 'medium',
              'high-risk-text'  : currentRiskLevel === 'high'
            }">
          {{ riskLevelText }}
        </h2>

        <p class="probability-text">
          ‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô:
          <span class="probability-value">
            {{ (predictionResult.probability * 100) | number:'1.2-2' }}%
          </span>
        </p>

        <!-- üîç DETAILS TOGGLE -->
        <ion-button expand="block"
                    fill="outline"
                    color="secondary"
                    (click)="viewDetails()">
          <ion-icon slot="start" name="information-circle-outline"></ion-icon>
          {{ showDetails ? '‡∏ã‡πà‡∏≠‡∏ô‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•' : '‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏£‡∏≠‡∏Å' }}
        </ion-button>
      </ion-card-content>
    </ion-card>

    <!-- ‚ñà 2 ‚îÄ USER-INPUT DETAILS -->
    <ion-card *ngIf="showDetails"
              class="details-card animate__animated animate__fadeInUp">
      <ion-card-header>
        <ion-card-title>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏Å‡∏£‡∏≠‡∏Å</ion-card-title>
      </ion-card-header>

      <ion-card-content>
        <ion-list lines="none">
          <ion-item>
            <ion-label>‡πÄ‡∏û‡∏®:</ion-label>
            <p slot="end">{{ predictionResult.inputData?.gender == 0 ? '‡∏ä‡∏≤‡∏¢' : '‡∏´‡∏ç‡∏¥‡∏á' }}</p>
          </ion-item>
          <ion-item>
            <ion-label>‡∏≠‡∏≤‡∏¢‡∏∏:</ion-label>
            <p slot="end">{{ predictionResult.inputData?.age }} ‡∏õ‡∏µ</p>
          </ion-item>
          <ion-item>
            <ion-label>‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥:</ion-label>
            <p slot="end">{{ predictionResult.inputData?.temp }} ¬∞C</p>
          </ion-item>
          <ion-item>
            <ion-label>‡∏ä‡∏µ‡∏û‡∏à‡∏£:</ion-label>
            <p slot="end">{{ predictionResult.inputData?.pulse }} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á/‡∏ô‡∏≤‡∏ó‡∏µ</p>
          </ion-item>
          <ion-item>
            <ion-label>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡∏´‡∏≤‡∏¢‡πÉ‡∏à:</ion-label>
            <p slot="end">{{ predictionResult.inputData?.rr }} ‡∏Ñ‡∏£‡∏±‡πâ‡∏á/‡∏ô‡∏≤‡∏ó‡∏µ</p>
          </ion-item>
          <ion-item>
            <ion-label>O2 Sat:</ion-label>
            <p slot="end">{{ predictionResult.inputData?.o2 }} %</p>
          </ion-item>
          <ion-item>
            <ion-label>‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å:</ion-label>
            <p slot="end">{{ predictionResult.inputData?.weight }} kg</p>
          </ion-item>
          <ion-item>
            <ion-label>‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á:</ion-label>
            <p slot="end">{{ predictionResult.inputData?.height }} cm</p>
          </ion-item>
        </ion-list>
        <ion-item *ngIf="predictionResult.rawOutput">
          <ion-label>Raw Output Probabilities:</ion-label>
          <p slot="end">{{ predictionResult.rawOutput | json }}</p>
        </ion-item>
      </ion-card-content>
    </ion-card>

    <!-- ‚ñà 3 ‚îÄ RECOMMENDATIONS -->
    <h3 *ngIf="filteredRecommendations.length > 0"
        class="recommendation-heading animate__animated animate__fadeInUp">
      ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏∏‡∏ì
    </h3>

    <ion-card class="care-card animate__animated animate__fadeInUp"
              *ngFor="let rec of filteredRecommendations; let i = index"
              [style.--animate-delay]="(0.3 + i * 0.1) + 's'">
      <ion-card-header>
        <ion-icon [name]="rec.icon"></ion-icon>
        <ion-card-title>{{ rec.title }}</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <p>{{ rec.description }}</p>
      </ion-card-content>
    </ion-card>

    <!-- ‚ñà 4 ‚îÄ CALL-A-DOCTOR CARD -->
    <ion-card class="care-card call-to-action-card animate__animated animate__fadeInUp"
              [style.--animate-delay]="(0.3 + filteredRecommendations.length * 0.1) + 's'">
      <ion-card-header>
        <ion-icon name="alert-circle-outline"></ion-icon>
        <ion-card-title>‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏û‡∏ó‡∏¢‡πå</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <p>‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏≠‡∏≤‡∏Å‡∏≤‡∏£‡∏ú‡∏¥‡∏î‡∏õ‡∏Å‡∏ï‡∏¥‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡∏™‡∏á‡∏™‡∏±‡∏¢‡πÉ‡∏î‡πÜ ‡πÇ‡∏õ‡∏£‡∏î‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏û‡∏ó‡∏¢‡πå‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡∏ó‡∏±‡∏ô‡∏ó‡∏µ.</p>
        <ion-button expand="block"
                    fill="clear"
                    color="tertiary"
                    class="call-doctor-button"
                    routerLink="/contact">
          <ion-icon slot="start" name="call-outline"></ion-icon>
          ‡πÇ‡∏ó‡∏£‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏û‡∏ó‡∏¢‡πå
        </ion-button>
      </ion-card-content>
    </ion-card>

    <!-- ‚ñà 5 ‚îÄ NEW GUIDELINE DOWNLOAD CARD -->
    <ion-card class="guideline-card animate__animated animate__fadeInUp"
              [style.--animate-delay]="(0.3 + (filteredRecommendations.length + 1) * 0.1) + 's'">
      <ion-card-header>
        <ion-icon name="document-text-outline"></ion-icon>
        <ion-card-title>‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</ion-card-title>
      </ion-card-header>
      <ion-card-content>
        <p>
          ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠ <strong>‡πÇ‡∏£‡∏Ñ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡πÇ‡∏•‡∏´‡∏¥‡∏ï‡∏™‡∏π‡∏á</strong><br>
          ‡∏à‡∏≤‡∏Å <em>‡∏™‡∏°‡∏≤‡∏Ñ‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡πÇ‡∏•‡∏´‡∏¥‡∏ï‡∏™‡∏π‡∏á‡πÅ‡∏´‡πà‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®‡πÑ‡∏ó‡∏¢</em><br>
          (‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÇ‡∏£‡∏Ñ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡πÇ‡∏•‡∏´‡∏¥‡∏ï‡∏™‡∏π‡∏á‡πÉ‡∏ô‡πÄ‡∏ß‡∏ä‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ ‡∏û.‡∏®. 2567<br>
          <small>2024 Thai Guidelines on the Treatment of Hypertension</small>)
        </p>

        <ion-button expand="block"
                    fill="solid"
                    color="primary"
                    href="assets/pdfs/‡πÇ‡∏£‡∏Ñ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡πÇ‡∏•‡∏´‡∏¥‡∏ï‡∏™‡∏π‡∏á.pdf"
                    download="‡πÇ‡∏£‡∏Ñ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡πÇ‡∏•‡∏´‡∏¥‡∏ï‡∏™‡∏π‡∏á.pdf">
          <ion-icon slot="start" name="download-outline"></ion-icon>
          ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (PDF)
        </ion-button>
      </ion-card-content>
    </ion-card>

    <!-- ‚ñà 6 ‚îÄ FOOTER -->
    <div class="footer-section ion-text-center animate__animated animate__fadeInUp"
         [style.--animate-delay]="(0.3 + (filteredRecommendations.length + 2) * 0.1) + 's'">
      <p>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô ‡πÇ‡∏õ‡∏£‡∏î‡∏õ‡∏£‡∏∂‡∏Å‡∏©‡∏≤‡∏ú‡∏π‡πâ‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏û‡∏ó‡∏¢‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•</p>
      <ion-button fill="clear"
                  routerLink="/contact"
                  class="secondary-info-button">
        <ion-icon slot="start" name="information-circle-outline"></ion-icon>
        ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÄ‡∏£‡∏≤
      </ion-button>
    </div>
  </div>

  <!-- ‚ñà 7 ‚îÄ NO-DATA MESSAGE -->
  <div *ngIf="!predictionResult"
       class="no-data-message ion-text-center animate__animated animate__fadeIn">
    <ion-icon name="alert-circle-outline"></ion-icon>
    <p>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏ô‡∏≤‡∏¢ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Input ‡∏Å‡πà‡∏≠‡∏ô</p>
    <ion-button expand="block"
                color="primary"
                routerLink="/input">
      <ion-icon slot="start" name="arrow-back-outline"></ion-icon>
      ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤ Input
    </ion-button>
  </div>
</ion-content>
